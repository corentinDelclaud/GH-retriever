Namespace(model_name='graph_llm', project='project_g_retriever', seed=0, dataset='expla_graphs', lr=1e-05, wd=0.05, patience=2, batch_size=8, grad_steps=2, num_epochs=10, warmup_epochs=1, eval_batch_size=16, llm_model_name='7b', llm_model_path='', llm_frozen='True', llm_num_virtual_tokens=10, output_dir='output', max_txt_len=512, max_new_tokens=32, max_memory=[40], gnn_model_name='gt2', gnn_num_layers=4, gnn_in_dim=1024, gnn_hidden_dim=1024, gnn_num_heads=4, gnn_dropout=0.0)
Loading LLAMA
Loading checkpoint shards: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.50it/s]
Freezing LLAMA!
Finish loading LLAMA!
trainable params: 90236928 || all params: 6828652544 || trainable%: 1.3214455914774392
 40%|████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                                                                  | 828/2070 [10:45<14:24,  1.44it/s]/home/naeem/miniconda3/envs/g_retriever_HYBRID/lib/python3.9/site-packages/torch/cuda/memory.py:329: FutureWarning: torch.cuda.reset_max_memory_allocated now calls torch.cuda.reset_peak_memory_stats, which resets /all/ peak memory stats.
Epoch: 0|10: Train Loss (Epoch Mean): 0.9015398214116764
Epoch: 0|10: Val Loss: 0.36977642178535464
Saving checkpoint at epoch 0 to output/expla_graphs/model_name_graph_llm_llm_model_name_7b_llm_frozen_True_max_txt_len_512_max_new_tokens_32_gnn_model_name_gt2_patience_2_num_epochs_10_seed0_checkpoint_best.pth.
Epoch 0 Val Loss 0.36977642178535464 Best Val Loss 0.36977642178535464 Best Epoch 0
Epoch: 1|10: Train Loss (Epoch Mean): 0.2672685408472097
Epoch: 1|10: Val Loss: 0.1752092131779396
Saving checkpoint at epoch 1 to output/expla_graphs/model_name_graph_llm_llm_model_name_7b_llm_frozen_True_max_txt_len_512_max_new_tokens_32_gnn_model_name_gt2_patience_2_num_epochs_10_seed0_checkpoint_best.pth.
Epoch 1 Val Loss 0.1752092131779396 Best Val Loss 0.1752092131779396 Best Epoch 1
Epoch: 2|10: Train Loss (Epoch Mean): 0.19479833171643307
Epoch: 2|10: Val Loss: 0.3160089833278367
Epoch 2 Val Loss 0.3160089833278367 Best Val Loss 0.1752092131779396 Best Epoch 1
Epoch: 3|10: Train Loss (Epoch Mean): 0.18652516722034565
Epoch: 3|10: Val Loss: 0.22677091422415938
Epoch 3 Val Loss 0.22677091422415938 Best Val Loss 0.1752092131779396 Best Epoch 1
Early stop at epoch 3
  warnings.warn(
path: output/expla_graphs/model_name_graph_llm_llm_model_name_7b_llm_frozen_True_max_txt_len_512_max_new_tokens_32_gnn_model_name_gt2_patience_2_num_epochs_10_seed0.csv
Loading checkpoint from output/expla_graphs/model_name_graph_llm_llm_model_name_7b_llm_frozen_True_max_txt_len_512_max_new_tokens_32_gnn_model_name_gt2_patience_2_num_epochs_10_seed0_checkpoint_best.pth.
 40%|████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                                                                  | 828/2070 [11:33<17:19,  1.19it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:24<00:00,  1.43it/s]
Accuracy: 0.8448
Precision: 0.8448
Recall: 0.8448
Test Accuracy: 0.8447653429602888
Test Precision: 0.8447653429602888
Test Recall: 0.8447653429602888
/home/naeem/miniconda3/envs/g_retriever_HYBRID/lib/python3.9/site-packages/torch/cuda/memory.py:329: FutureWarning: torch.cuda.reset_max_memory_allocated now calls torch.cuda.reset_peak_memory_stats, which resets /all/ peak memory stats.
  warnings.warn(
